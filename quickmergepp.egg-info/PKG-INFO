Metadata-Version: 2.4
Name: quickmergepp
Version: 0.1.0
Summary: QuickMerge++: Fast Token Merging with Autoregressive Prior
Author-email: Dong Liu <dong.liu.dl2367@yale.edu>, Yanxuan Yu <yy3523@columbia.edu>
Project-URL: Homepage, https://github.com/your-org/quickmergepp
Requires-Python: >=3.9
Description-Content-Type: text/markdown
Requires-Dist: torch>=2.1
Requires-Dist: numpy>=1.24
Requires-Dist: scikit-learn>=1.3

QuickMerge++: Fast Token Merging with Autoregressive Prior

Install
```bash
pip install -r requirements.txt
pip install -e .
```

Usage
```python
import torch
from quickmergepp import QuickMergePP

num_layers, batch, seq_len, dim = 4, 2, 128, 64
h = torch.randn(num_layers, batch, seq_len, dim)

qm = QuickMergePP(dim=dim, k_max=54, temperature=0.5)
merged, info = qm.compress(h)
preds = qm.ar_predict(merged)

print(merged.shape, preds.shape)
```

Demo
```bash
python scripts/demo.py
```

Modules
- Saliency: multi-scale attention entropy
- Merge: Gumbel-Softmax selection + weighted k-means
- AR prior: small causal transformer with bi-directional MSE losses for training
